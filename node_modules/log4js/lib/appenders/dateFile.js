"use strict";function appender(e,n,t,o,a){o=o||layouts.basicLayout;var r=new streams.DateRollingFileStream(e,n,{alwaysIncludePattern:t});return openFiles.push(r),function(e){r.write(o(e,a)+eol,"utf8")}}function configure(e,n){var t;return e.layout&&(t=layouts.layout(e.layout.type,e.layout)),e.alwaysIncludePattern||(e.alwaysIncludePattern=!1),n&&n.cwd&&!e.absolute&&(e.filename=path.join(n.cwd,e.filename)),appender(e.filename,e.pattern,e.alwaysIncludePattern,t,e.timezoneOffset)}function shutdown(e){var n,t=0,o=function(o){n=n||o,t++,t>=openFiles.length&&e(n)};return openFiles.length?void openFiles.forEach(function(e){e.write(eol,"utf-8")?e.end(o):e.once("drain",function(){e.end(o)})}):e()}var streams=require("../streams"),layouts=require("../layouts"),path=require("path"),os=require("os"),eol=os.EOL||"\n",openFiles=[];process.on("exit",function(){openFiles.forEach(function(e){e.end()})}),exports.appender=appender,exports.configure=configure,exports.shutdown=shutdown;