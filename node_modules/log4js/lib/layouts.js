"use strict";function wrapErrorsWithInspect(t){return t.map(function(t){return t instanceof Error&&t.stack?{inspect:function(){return semver.satisfies(process.version,">=6")?util.format(t):util.format(t)+"\n"+t.stack}}:t})}function formatLogData(t){var r=Array.isArray(t)?t:Array.prototype.slice.call(arguments);return util.format.apply(util,wrapErrorsWithInspect(r))}function colorizeStart(t){return t?"["+styles[t][0]+"m":""}function colorizeEnd(t){return t?"["+styles[t][1]+"m":""}function colorize(t,r){return colorizeStart(r)+t+colorizeEnd(r)}function timestampLevelAndCategory(t,r,e){var o=colorize(formatLogData("[%s] [%s] %s - ",dateFormat.asString(t.startTime,e),t.level,t.categoryName),r);return o}function basicLayout(t,r){return timestampLevelAndCategory(t,void 0,r)+formatLogData(t.data)}function colouredLayout(t,r){return timestampLevelAndCategory(t,colours[t.level.toString()],r)+formatLogData(t.data)}function messagePassThroughLayout(t){return formatLogData(t.data)}function dummyLayout(t){return t.data[0]}function patternLayout(t,r,e){function o(t,r){var e=t.categoryName;if(r){var o=parseInt(r,10),n=e.split(".");o<n.length&&(e=n.slice(n.length-o).join("."))}return e}function n(t,r){var o=dateFormat.ISO8601_FORMAT;return r&&(o=r,"ISO8601"==o?o=dateFormat.ISO8601_FORMAT:"ISO8601_WITH_TZ_OFFSET"==o?o=dateFormat.ISO8601_WITH_TZ_OFFSET_FORMAT:"ABSOLUTE"==o?o=dateFormat.ABSOLUTETIME_FORMAT:"DATE"==o&&(o=dateFormat.DATETIME_FORMAT)),dateFormat.asString(o,t.startTime,e)}function a(){return os.hostname().toString()}function u(t){return formatLogData(t.data)}function s(){return eol}function i(t){return t.level.toString()}function c(t){return dateFormat.asString("hh:mm:ss",t.startTime,e)}function l(t){return colorizeStart(colours[t.level.toString()])}function m(t){return colorizeEnd(colours[t.level.toString()])}function f(){return"%"}function y(t){return t&&t.pid?t.pid:process.pid}function d(t,r){return t.cluster&&r?r.replace("%m",t.cluster.master).replace("%w",t.cluster.worker).replace("%i",t.cluster.workerId):t.cluster?t.cluster.worker+"@"+t.cluster.master:y()}function g(t,e){return"undefined"!=typeof r[e]?"function"==typeof r[e]?r[e](t):r[e]:null}function p(t,r,e){return A[t](r,e)}function L(t,r){var e;return t?(e=parseInt(t.substr(1),10),r.substring(0,e)):r}function v(t,r){var e;if(t)if("-"==t.charAt(0))for(e=parseInt(t.substr(1),10);r.length<e;)r+=" ";else for(e=parseInt(t,10);r.length<e;)r=" "+r;return r}function T(t,r,e){var o=t;return o=L(r,o),o=v(e,o)}var h="%r %p %c - %m%n",F=/%(-?[0-9]+)?(\.?[0-9]+)?([\[\]cdhmnprzxy%])(\{([^\}]+)\})?|([^%]+)/;t=t||h;var A={c:o,d:n,h:a,m:u,n:s,p:i,r:c,"[":l,"]":m,y:d,z:y,"%":f,x:g};return function(r){for(var e,o="",n=t;e=F.exec(n);){var a=(e[0],e[1]),u=e[2],s=e[3],i=e[5],c=e[6];if(c)o+=""+c;else{var l=p(s,r,i);o+=T(l,u,a)}n=n.substr(e.index+e[0].length)}return o}}var dateFormat=require("./date_format"),os=require("os"),eol=os.EOL||"\n",util=require("util"),semver=require("semver"),replacementRegExp=/%[sdj]/g,layoutMakers={messagePassThrough:function(){return messagePassThroughLayout},basic:function(){return basicLayout},colored:function(){return colouredLayout},coloured:function(){return colouredLayout},pattern:function(t){return patternLayout(t&&t.pattern,t&&t.tokens)},dummy:function(){return dummyLayout}},colours={ALL:"grey",TRACE:"blue",DEBUG:"cyan",INFO:"green",WARN:"yellow",ERROR:"red",FATAL:"magenta",OFF:"grey"},styles={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[90,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};module.exports={basicLayout:basicLayout,messagePassThroughLayout:messagePassThroughLayout,patternLayout:patternLayout,colouredLayout:colouredLayout,coloredLayout:colouredLayout,dummyLayout:dummyLayout,addLayout:function(t,r){layoutMakers[t]=r},layout:function(t,r){return layoutMakers[t]&&layoutMakers[t](r)}};